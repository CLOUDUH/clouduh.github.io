---
layout: post
title: 折腾小主机物尽其用
subtitle: ""
date: 2025-08-07
author: CLOUDUH
header-img: /cloudu-oss.oss-cn-beijing.aliyuncs.com/blogimg/home-bg.jpg
permalink: /post/250807
tags:
  - Homelab
---

# N95 主机安装 PVE 以及 CentOS 虚拟机

## Abstract

本文主要记录了如何安装 PVE 以及安装虚拟机 CentOS，部分内容和图片来源自网络其他博主的博客。

## 1 PVE 安装

### 1.1 软件下载

下载 PVE ISO 镜像

[Download Proxmox software, datasheets, agreements](https://www.proxmox.com/en/downloads)

![](../attachment/Pasted%20image%2020250807112555.png)

下载 balenaEtcher，用于镜像烧录

>  这边我直接选择了 macOS 的版本

[balenaEtcher - Flash OS images to SD cards & USB drives](https://etcher.balena.io/)

![](../attachment/Pasted%20image%2020250807112725.png)
### 1.2 镜像烧录

选择好镜像文件，确定烧录 U 盘，进行烧录。

![](../attachment/Pasted%20image%2020250807112826.png)

完成后如图所示（网图）：

![](../attachment/Pasted%20image%2020250807112918.png)

### 1.3 Bios 必要设置

![](../attachment/Pasted%20image%2020250807113412.png)

狂按 Delete 进行 BIOS 设置界面

![](../attachment/Pasted%20image%2020250807113428.png)

开启 CPU 虚拟化技术：选择 **Advanced——Intel Virtualization Technology**，更改为 Enable

开启主板来电自启：选择 **Chipset——PCH-IO Cofiguration——State After G3**，更改为 S0 State

### 1.4 安装设置

狂按 F7 设置 U 盘启动，进入安装界面

![](../attachment/Pasted%20image%2020250807113939.png)

![](../attachment/Pasted%20image%2020250807113952.png)

![](../attachment/Pasted%20image%2020250807114003.png)

设置存储空间大小为总容量-1G，据说是方便调整

设置 Swap 空间为 4GB

![](../attachment/Pasted%20image%2020250807114033.png)

设置时区

![](../attachment/Pasted%20image%2020250807114147.png)

设置密码和邮箱

![](../attachment/Pasted%20image%2020250807114155.png)

设置网口和主机名

- 网口要选择有线网口作为管理口，无线可以后续再添加
- 主机名需要是域名，可以随便填一个
- IP 地址根据路由器需要填写，我这里是 192.168.1.50 / 192.168.1.1 / 192.168.1.1

![](../attachment/Pasted%20image%2020250807114222.png)
确认安装

![](../attachment/Pasted%20image%2020250807114421.png)

重启之后拔掉 U 盘，不然还会进入安装环境

![](../attachment/Pasted%20image%2020250807114446.png)

进入后就会限制一个 IP 地址，访问此 IP 地址即可，注意端口为 8006

![](../attachment/Pasted%20image%2020250807114503.png)

![](../attachment/Pasted%20image%2020250807114558.png)
## 2 安装 CentOS 虚拟机

这里以 CentOS 为例子

> 为什么选择 CentOS，因为相比于 Ubuntu 更加稳定，而且更加精简。

### 2.1 下载镜像

推荐下载 CentOS 7.9，选择 Minimal 版本，更加精简。

官方下载网站：

[Index of /7.9.2009/isos/x86\_64](https://vault.centos.org/7.9.2009/isos/x86_64/)

阿里云镜像网站：

[centos-7.9.2009-isos-x86\_64安装包下载\_开源镜像站-阿里云](https://mirrors.aliyun.com/centos/7.9.2009/isos/x86_64/)

> 网络良好就不要用阿里云镜像

下载完成后上传镜像文件到 Local 存储中

![](../attachment/Pasted%20image%2020250807114957.png)

### 2.2 创建虚拟机

点击创建虚拟机，设置 ID 与名称，设置开机自启

![](../attachment/Pasted%20image%2020250807115215.png)

选择刚上传的镜像文件

![](../attachment/Pasted%20image%2020250807115307.png)


建议开启 QEMU 代理（方便资源动态分配）

![](../attachment/Pasted%20image%2020250807115359.png)

选择磁盘编号，分配大小，有多个硬盘可以多个存储。

![](../attachment/Pasted%20image%2020250807115446.png)

设置 CPU 核心数和类比，选择 KVM64 兼容性更好，选择 HOST 类型直接使用物理机配置，无论如何建议插槽为 1，核心数量不超过物理机实际数量。

![](../attachment/Pasted%20image%2020250807115710.png)

内存根据需求选择，如果开启 QEMU，可以将内存分配至物理机内存大小

![](../attachment/Pasted%20image%2020250807115756.png)

网络默认配置即可

![](../attachment/Pasted%20image%2020250807115819.png)

确认后创建

![](../attachment/Pasted%20image%2020250807115906.png)

### 2.3 安装 CentOS

选择 Install CentOS 7

![](../attachment/Pasted%20image%2020250807120027.png)

选择语言

![](../attachment/Pasted%20image%2020250807120037.png)

选择安装分区

![](../attachment/Pasted%20image%2020250807120054.png)

![](../attachment/Pasted%20image%2020250807120107.png)

点击安装即可

![](../attachment/Pasted%20image%2020250807120332.png)

设置 Root 密码和账户

![](../attachment/Pasted%20image%2020250807120415.png)

安装完之后，选择控制台，即可完成。

![](../attachment/Pasted%20image%2020250807120706.png)
## 3 配置 CentOS

输入 root 然后输入密码，进入管理员模式

>  注意小键盘可能不能用

![](../attachment/Pasted%20image%2020250807120939.png)
### 3.1 配置网络

查看网卡是哪一个，一般是 eth0

```shell
ip a
```

![](../attachment/Pasted%20image%2020250807121029.png)

进入网卡配置，修改必要参数

```shell
vi /etc/sysconfig/network-scripts/ifcfg-eth0
```

![](../attachment/Pasted%20image%2020250807121254.png)

- 按 i 进入编辑模式
- 按 esc 退出编辑模式
- 输入 `:wq!` 保存并退出

修改如下，如果路由器有 DHCP 就不用设置 IP 地址了。

```shell
BOOTPROTO=static
ONBOOT=yes
```

重启一下网络服务

```shell
sudo systemctl restart network
```

![](../attachment/Pasted%20image%2020250807121751.png)

> 从此以后就用 SSH 远程连接把，这个控制台没办法复制粘贴

### 3.2 替换源

```shell
sudo sed -i.bak 's|^mirrorlist=|#mirrorlist=|g' /etc/yum.repos.d/CentOS-Base.repo
sudo sed -i 's|^#baseurl=http://mirror.centos.org|baseurl=http://mirrors.aliyun.com|g' /etc/yum.repos.d/CentOS-Base.repo
sudo yum clean all
sudo yum makecache
```

### 3.3 安装 QEMU

安装，开启，最后查看状态

```shell
sudo yum install -y qemu-guest-agent

sudo systemctl enable qemu-guest-agent
sudo systemctl start qemu-guest-agent

systemctl status qemu-guest-agent
```

## 4 安装 Debian 虚拟机

### 4.1 下载镜像

下载小型安装映像

[下载 Debian](https://www.debian.org/distrib/)

后续导入步骤同理，不再赘述

### 4.2 安装 Debian

![](../attachment/Pasted%20image%2020250807150729.png)

按着操作一路来就可以了，debian 安装比较简单

![](../attachment/Pasted%20image%2020250807151726.png)

![](../attachment/Pasted%20image%2020250807151744.png)

![](../attachment/Pasted%20image%2020250807151846.png)

![](../attachment/Pasted%20image%2020250807151901.png)

![](../attachment/Pasted%20image%2020250807151940.png)

![](../attachment/Pasted%20image%2020250807151109.png)

![](../attachment/Pasted%20image%2020250807152125.png)

正在扫描镜像站点卡了很久，解决办法是拔下网线

![](../attachment/Pasted%20image%2020250807152416.png)

![](../attachment/Pasted%20image%2020250807152325.png)

点击返回

### 4.3 配置 Debian

恢复网络设置，先不要弹出 ISO 镜像

禁用 IPv6 网络，修改文件

```shell
sudo nano /etc/sysctl.conf
```

在末尾添加：

```shell
net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
net.ipv6.conf.lo.disable_ipv6 = 1
```

按 Ctrl+S 保存，随后 Ctrl+X 退出，随后执行

```shell
sudo sysctl -p
```

开启 SSH 服务

> 当前没有配置镜像源头，所以可以先用 ISO 安装不弹出

```shell
apt install -y openssh-server
service ssh start
systemctl status sshd
```

![](../attachment/Pasted%20image%2020250807154924.png)

此时还不行，需要安装 VIM 并修改 SSH 配置

```shell
apt install -y vim
vim /etc/ssh/sshd_config
```

![](../attachment/Pasted%20image%2020250807155326.png)

随后重启 SSH 服务

```shell
systemctl restart sshd
```

更换源

```shell
nano /etc/apt/sources.list
```

```shell
deb http://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm main contrib non-free non-free-firmware
deb http://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-updates main contrib non-free non-free-firmware
deb http://mirrors.tuna.tsinghua.edu.cn/debian-security bookworm-security main contrib non-free non-free-firmware
```

```shell
apt update
```
## 5 Reference

[pve8.1 安装、创建centos7虚拟机及配置\_pve安装centos7-CSDN博客](https://blog.csdn.net/qq_32429805/article/details/135845394)

[\[零刻\]EQ12&EQ12Pro设置来电开机自启教程 - 哔哩哔哩]( https://www.bilibili.com/opus/800630574811185206 )

[\[零刻\]EQ12安装PVE虚拟机教程-CSDN博客](https://blog.csdn.net/u012514495/article/details/129861593)